build:
   image: python:2.7
   
before_install:
   commands:
      - sudo apt-get update -qq

install:
   commands:
      - pip install ansible
      - cd tests
      - ansible-galaxy install novuso.php-ext

script:
   commands:
      - "ansible-playbook playbook.yml --syntax-check"
      - "ansible-playbook playbook.yml --connection=local"
      - >
        ansible-playbook playbook.yml --connection=local
        | grep -q 'changed=0.*failed=0'
        && (echo 'Idempotence test: pass' && exit 0)
        || (echo 'Idempotence test: fail' && exit 1)
